<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Sisli Orman GÃ¼nlÃ¼kleri - BÃ¶lÃ¼m 1</title>
    <style>
        :root { --gold: #f1c40f; --bg: #0d0d0d; --panel: #1a1a1a; --text: #e0e0e0; --blue: #3498db; --red: #e74c3c; }
        body { background: var(--bg); color: var(--text); font-family: 'Garamond', serif; margin: 0; overflow: hidden; }
        
        /* Ana GÃ¶rÃ¼nÃ¼m */
        #game-view { height: 100vh; display: flex; flex-direction: column; position: relative; }
        #display { flex: 1; padding: 25px; overflow-y: auto; background: linear-gradient(to bottom, #111, #000); }
        .log { margin-bottom: 12px; padding: 12px; border-radius: 8px; background: rgba(255,255,255,0.03); border-left: 3px solid #444; animation: fadeIn 0.4s; }
        .player-speech { color: var(--blue); font-style: italic; }
        .elas-speech { color: var(--gold); }

        /* SavaÅŸ HUD */
        #battle-panel { background: #1a0505; padding: 15px; border-top: 2px solid var(--red); display: none; }
        .hp-bar { height: 12px; background: #000; border-radius: 6px; margin: 5px 0; overflow: hidden; border: 1px solid #333; }
        .hp-fill { height: 100%; background: #2ecc71; width: 100%; transition: 0.4s; }

        /* MenÃ¼ Butonu */
        #menu-trigger { position: fixed; bottom: 20px; right: 20px; width: 65px; height: 65px; background: var(--gold); color: #000; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 30px; cursor: pointer; z-index: 1000; box-shadow: 0 0 20px rgba(241,196,15,0.3); }

        /* MenÃ¼ Overlay */
        .overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 999; flex-direction: column; align-items: center; justify-content: center; }
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 300px; }
        .opt-btn { background: #222; color: white; border: 1px solid #444; padding: 15px; border-radius: 8px; cursor: pointer; transition: 0.2s; text-align: center; }
        .opt-btn:hover { border-color: var(--gold); background: #2a2a2a; }
        .locked { opacity: 0.3; cursor: not-allowed; }

        /* Diyalog Penceresi */
        #dialogue-box { position: fixed; bottom: 0; width: 100%; background: #111; border-top: 3px solid var(--gold); padding: 25px; display: none; z-index: 2000; box-sizing: border-box; }
        
        input, select { padding: 12px; margin: 10px; border-radius: 5px; border: 1px solid var(--gold); background: #222; color: white; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; } }
    </style>
</head>
<body>

    <div id="setup" class="overlay" style="display:flex;">
        <h2 style="color:var(--gold)">RUHUNU UYANDIR</h2>
        <input type="text" id="p-name-in" placeholder="Kahraman AdÄ±...">
        <select id="p-class-in">
            <option value="savasci">SavaÅŸÃ§Ä±</option>
            <option value="buyucu">BÃ¼yÃ¼cÃ¼</option>
            <option value="avci">AvcÄ±</option>
            <option value="sifaci">ÅifacÄ±</option>
        </select>
        <button class="opt-btn" onclick="initGame()">BAÅLA</button>
    </div>

    <div id="game-view">
        <div id="display"></div>
        
        <div id="battle-panel">
            <div style="display:flex; justify-content:space-between; font-size:14px;">
                <div style="width:45%">Kahraman: <span id="p-hp-val">100</span><div class="hp-bar"><div id="p-hp-fill" class="hp-fill"></div></div></div>
                <div style="width:45%"><span id="m-name">Canavar</span>: <span id="m-hp-val">50</span><div class="hp-bar"><div id="m-hp-fill" class="hp-fill" style="background:var(--red)"></div></div></div>
            </div>
            <div id="battle-actions" style="margin-top:10px; display:flex; gap:5px;">
                <button class="opt-btn" style="flex:1" onclick="playerAction('attack')">âš”ï¸ SaldÄ±r</button>
                <div id="skill-zone" style="display:flex; gap:5px;"></div>
            </div>
        </div>

        <button id="explore-btn" onclick="spawnMonster()" style="padding:20px; background:var(--blue); border:none; color:white; font-weight:bold; cursor:pointer; display:none;">ORMANI KEÅFET</button>
    </div>

    <div id="main-menu" class="overlay">
        <h2 style="color:var(--gold)">ANA MENÃœ</h2>
        <div class="menu-grid">
            <div class="opt-btn" onclick="showProfile()">ğŸ‘¤ Profil</div>
            <div id="btn-bag" class="opt-btn locked" onclick="showBag()">ğŸ’ Ã‡anta</div>
            <div id="btn-equip" class="opt-btn locked" onclick="showEquip()">âš”ï¸ Ekipman</div>
            <div id="btn-pet" class="opt-btn locked" onclick="showPetSub()">ğŸ¾ Evcil Hayvan</div>
            <div id="btn-mount" class="opt-btn locked" onclick="showMountSub()">ğŸ Binek</div>
            <div class="opt-btn" style="background:var(--red)" onclick="closeMenus()">âŒ Kapat</div>
        </div>
    </div>

    <div id="dialogue-box">
        <div id="speaker" style="color:var(--gold); font-weight:bold; margin-bottom:10px;">Elas</div>
        <div id="diag-text" style="margin-bottom:15px; font-style:italic;">...</div>
        <div id="diag-opts" style="display:flex; flex-direction:column; gap:8px;"></div>
    </div>

<script>
    // --- VERÄ°LER VE DURUM ---
    let player = {
        name: "", class: "", lvl: 1, xp: 0, nextXp: 100, hp: 100, maxHp: 100, 
        attack: 10, gold: 0, lastStory: 0,
        bag: { equipments: [], consumables: [] },
        equip: { weapon: null },
        myPets: [], myMounts: [], skills: []
    };

    const monsterDB = [
        { name: "Yavru Kurt", min: 1, hp: 30, dmg: 4 },
        { name: "Zehirli Ã–rÃ¼mcek", min: 1, hp: 35, dmg: 6 },
        { name: "Bozuk Ä°skelet", min: 4, hp: 70, dmg: 10 },
        { name: "GÃ¶lge Hayaleti", min: 4, hp: 60, dmg: 12 },
        { name: "Orman TrolÃ¼", min: 7, hp: 130, dmg: 15 },
        { name: "BataklÄ±k CadÄ±sÄ±", min: 8, hp: 110, dmg: 20 }
    ];

    const classData = {
        savasci: { skill1: "Sarsan Darbe", ulti: "Ejderha KÃ¼kremesi" },
        buyucu: { skill1: "Mana KalkanÄ±", ulti: "Kozmik Patlama" },
        avci: { skill1: "Ä°z SÃ¼rme", ulti: "GÃ¶lge YaÄŸmuru" },
        sifaci: { skill1: "Kutsal IÅŸÄ±k", ulti: "Anka DiriliÅŸi" }
    };

    let enemy = null;

    // --- BAÅLATMA ---
    function initGame() {
        player.name = document.getElementById('p-name-in').value || "Yolcu";
        player.class = document.getElementById('p-class-in').value;
        document.getElementById('setup').style.display = 'none';
        addLog("GÃ¶zlerini aÃ§Ä±yorsun... Sisli bir ormandasÄ±n.");
        triggerDialogue('intro');
    }

    // --- SAVAÅ SÄ°STEMÄ° ---
    function spawnMonster() {
        let pool = monsterDB.filter(m => player.lvl >= m.min);
        let m = pool[Math.floor(Math.random() * pool.length)];
        enemy = { ...m, maxHp: m.hp };
        
        document.getElementById('m-name').innerText = enemy.name;
        document.getElementById('explore-btn').style.display = 'none';
        document.getElementById('battle-panel').style.display = 'block';
        updateBars();
        addLog(`Bir ${enemy.name} belirdi!`);
    }

    function playerAction(type) {
        let dmg = player.attack + (player.equip.weapon ? 15 : 0);
        enemy.hp -= dmg;
        addLog(`DÃ¼ÅŸmana ${dmg} hasar verdin.`);
        
        if(enemy.hp <= 0) {
            winBattle();
        } else {
            setTimeout(enemyTurn, 600);
        }
        updateBars();
    }

    function enemyTurn() {
        if(!enemy) return;
        let dmg = enemy.dmg;
        player.hp -= dmg;
        addLog(`${enemy.name} sana ${dmg} vurdu.`);
        if(player.hp <= 0) {
            addLog("BayÄ±ldÄ±n... Elas seni kampa taÅŸÄ±dÄ±.");
            player.hp = player.maxHp;
            endBattle();
        }
        updateBars();
    }

    function winBattle() {
        let gain = 40 + (player.lvl * 5);
        player.xp += gain;
        addLog(`KazandÄ±n! ${gain} XP kazandÄ±n.`);
        if(player.xp >= player.nextXp) levelUp();
        endBattle();
    }

    function endBattle() {
        enemy = null;
        document.getElementById('battle-panel').style.display = 'none';
        document.getElementById('explore-btn').style.display = 'block';
    }

    // --- SEVÄ°YE VE HÄ°KAYE ---
    function levelUp() {
        player.lvl++;
        player.xp = 0;
        player.nextXp += 50;
        addLog(`<b style="color:var(--gold)">SEVÄ°YE ATLADIN: ${player.lvl}!</b>`);
        
        if(player.lvl === 3) {
            unlock('btn-bag'); unlock('btn-equip');
            player.bag.equipments.push({name: "PaslÄ± KÄ±lÄ±Ã§", type: "weapon", power: 15});
            addLog("Elas sana eski bir kÄ±lÄ±Ã§ verdi! Ã‡antandan kuÅŸan.");
        }
        if(player.lvl === 5) {
            player.skills.push(classData[player.class].skill1);
            triggerDialogue('awakening');
            renderSkills();
        }
        if(player.lvl === 8) {
            unlock('btn-pet');
            player.bag.consumables.push({name: "Ruh Cevheri", type: "pet_egg"});
            addLog("YaralÄ± bir ruh buldun. Cevheri kullanarak onu kurtar!");
        }
        if(player.lvl === 10) {
            unlock('btn-mount');
            player.skills.push(classData[player.class].ulti);
            triggerDialogue('final');
            renderSkills();
        }
    }

    // --- MENÃœ Ä°ÅLEMLERÄ° ---
    function closeMenus() { document.querySelectorAll('.overlay').forEach(o => o.style.display = 'none'); }
    function toggleMenu() { document.getElementById('main-menu').style.display = 'flex'; }
    function unlock(id) { document.getElementById(id).classList.remove('locked'); }

    function showProfile() {
        const m = document.getElementById('main-menu');
        m.innerHTML = `
            <h2 style="color:var(--gold)">PROFÄ°L</h2>
            <div style="background:#222; padding:20px; border-radius:10px; width:250px;">
                <p>Ä°sim: ${player.name}</p>
                <p>Seviye: ${player.lvl}</p>
                <p>SÄ±nÄ±f: ${player.class.toUpperCase()}</p>
                <p>XP: ${player.xp}/${player.nextXp}</p>
            </div>
            <button class="opt-btn" style="margin-top:10px" onclick="backToMain()">ğŸ”™ Geri</button>
        `;
    }

    function showBag() {
        const m = document.getElementById('main-menu');
        m.innerHTML = `
            <h2 style="color:var(--gold)">Ã‡ANTA</h2>
            <button class="opt-btn" style="width:200px; margin:5px;" onclick="renderBagItems('equipments')">âš”ï¸ Ekipmanlar</button>
            <button class="opt-btn" style="width:200px; margin:5px;" onclick="renderBagItems('consumables')">ğŸ§ª KullanÄ±labilir</button>
            <button class="opt-btn" style="margin-top:10px" onclick="backToMain()">ğŸ”™ Geri</button>
        `;
    }

    function renderBagItems(cat) {
        const m = document.getElementById('main-menu');
        let items = player.bag[cat];
        let html = `<h2 style="color:var(--gold)">${cat.toUpperCase()}</h2>`;
        items.forEach((it, i) => {
            html += `<div style="background:#333; padding:10px; margin:5px; width:220px; display:flex; justify-content:space-between;">
                ${it.name} <button onclick="useItem('${cat}', ${i})">${cat==='equipments'?'KuÅŸan':'Kullan'}</button>
            </div>`;
        });
        html += `<button class="opt-btn" onclick="showBag()">ğŸ”™ Geri</button>`;
        m.innerHTML = html;
    }

    function useItem(cat, index) {
        let it = player.bag[cat][index];
        if(cat === 'equipments') {
            player.equip.weapon = it;
            addLog(`${it.name} kuÅŸandÄ±n.`);
        } else if(it.type === 'pet_egg') {
            player.myPets.push({name: "Pofuduk", desc: "Can Yeniler"});
            addLog("Pofuduk artÄ±k seninle!");
        }
        player.bag[cat].splice(index, 1);
        backToMain();
    }

    // --- DÄ°YALOGLAR ---
    const diags = {
        intro: { t: "Elas: 'Uyan yolcu... Sisli ormanda kimsesiz dolaÅŸmak Ã¶lÃ¼me davetiye Ã§Ä±karmaktÄ±r. Kim olduÄŸunu hatÄ±rlÄ±yor musun?'", o: [{t: "HatÄ±rlamÄ±yorum, sadece karanlÄ±k...", n: "close"}] },
        awakening: { t: "Elas: 'DÃ¶vmen! ParlÄ±yor! Ä°Ã§indeki kadim gÃ¼Ã§ uyanÄ±yor!'", o: [{t: "Bu acÄ± da ne?!", n: "close"}] },
        final: { t: "Elas: 'KÃ¶prÃ¼ye ulaÅŸtÄ±k. Al bu tahta atÄ±, krallÄ±k yolu Ã§etindir. Yolun aÃ§Ä±k olsun.'", o: [{t: "TeÅŸekkÃ¼rler Elas, hoÅŸÃ§a kal.", n: "close"}] }
    };

    function triggerDialogue(key) {
        if(key === 'close') { document.getElementById('dialogue-box').style.display = 'none'; document.getElementById('explore-btn').style.display = 'block'; return; }
        let d = diags[key];
        document.getElementById('dialogue-box').style.display = 'block';
        document.getElementById('diag-text').innerText = d.t;
        let oBox = document.getElementById('diag-opts');
        oBox.innerHTML = "";
        d.o.forEach(opt => {
            let b = document.createElement("button");
            b.className = "opt-btn";
            b.innerText = opt.t;
            b.onclick = () => triggerDialogue(opt.n);
            oBox.appendChild(b);
        });
    }

    // --- YARDIMCI ---
    function backToMain() { closeMenus(); toggleMenu(); }
    function addLog(m) {
        const d = document.getElementById('display');
        d.innerHTML += `<div class="log">> ${m}</div>`;
        d.scrollTop = d.scrollHeight;
    }
    function updateBars() {
        document.getElementById('p-hp-val').innerText = player.hp;
        document.getElementById('p-hp-fill').style.width = (player.hp/player.maxHp*100) + "%";
        if(enemy) {
            document.getElementById('m-hp-val').innerText = enemy.hp;
            document.getElementById('m-hp-fill').style.width = (enemy.hp/enemy.maxHp*100) + "%";
        }
    }
    function renderSkills() {
        const sz = document.getElementById('skill-zone');
        sz.innerHTML = "";
        player.skills.forEach(s => {
            let b = document.createElement("button");
            b.className = "opt-btn";
            b.innerText = "âœ¨ " + s;
            b.onclick = () => { playerAction('skill'); addLog(`${s} kullanÄ±ldÄ±!`); };
            sz.appendChild(b);
        });
    }

    // Pet/Mount MenÃ¼leri (Basit Versiyon)
    function showPetSub() {
        const m = document.getElementById('main-menu');
        m.innerHTML = `<h2 style="color:var(--gold)">EVCÄ°L HAYVANLARIM</h2>
        ${player.myPets.map(p => `<p>ğŸ¾ ${p.name} (${p.desc})</p>`).join('')}
        <button class="opt-btn" onclick="backToMain()">ğŸ”™ Geri</button>`;
    }
    function showMountSub() {
        const m = document.getElementById('main-menu');
        m.innerHTML = `<h2 style="color:var(--gold)">BÄ°NEKLERÄ°M</h2>
        ${player.myMounts.map(p => `<p>ğŸ Tahta At</p>`).join('')}
        <button class="opt-btn" onclick="backToMain()">ğŸ”™ Geri</button>`;
    }
</script>

<div id="menu-trigger" onclick="toggleMenu()">ğŸ“œ</div>
</body>
</html>
